[platformio]
build_cache_dir = .pio/cache
workspace_dir = .pio/workspace

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
board_build.partitions = min_spiffs.csv

lib_deps =
	bodmer/TFT_eSPI@^2.5.43
	Links2004/WebSockets@^2.7.1
	bblanchon/ArduinoJson@^7.0.0
	adafruit/MAX6675 library@^1.1.2
	adafruit/Adafruit MLX90614 Library@^2.1.5
    xreef/PCF8574 library
	MaffooClock/ESP32RotaryEncoder@^1.2.0

build_unflags =
    -std=gnu++11
    -std=c++11
    -fno-rtti
    -fno-exceptions
    -Os

build_flags =
    -DCORE_DEBUG_LEVEL=0
  	-Wl,-Map,firmware.map
    # Optimierung für schnellere Kompilierung
    -O2
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections
    
    # C++ Standard
    -std=gnu++17
    -fexceptions
    -frtti
    
    # Version Info
    -D 'FIRMWARE_VERSION="1.4.0"'
    -D 'BUILD_DATE=__DATE__ " " __TIME__'
    -D 'BUILD_TIME=__TIME__'
	-Wno-cpp
	
    # Include Paths
	-Ilib/ESP
	-Ilib/Assets
	-Ilib/State
	-Ilib/UI
	-Ilib/TempSensor
	-Iinclude/app
	-Iinclude/core
	-Iinclude/net
	-Iinclude/ui
	-Iinclude/hardware
	-Iinclude/utils
	-Iinclude/driver
	-Iinclude/heater
	
    # TFT Display Config
	-D USER_SETUP_LOADED=1
	-D ST7789_DRIVER=1
	-D TFT_WIDTH=240
	-D TFT_HEIGHT=280
	-D TFT_MOSI=23
	-D TFT_SCLK=18
	-D TFT_CS=5
	-D TFT_DC=4
	-D TFT_RST=15
	-D SPI_FREQUENCY=40000000


    -DCONFIG_ESP32_WIFI_NVS_ENABLED=0
    -DCONFIG_WPA3_SAE_PWE_BOTH=0
	
    # TFT Fonts - NUR die genutzten!
	-DLOAD_GFXFF=1
	-DSMOOTH_FONT=1
    -D SUPPORT_8BIT_PALETTE
	-D TFT_eSPI_NO_TOUCH=1

# Parallelisierung für Windows
extra_scripts = 
    pre:scripts/build.py